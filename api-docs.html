<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SBTC Zona 5 - API Documentation</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Specific styles for API documentation */
        .api-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .api-header {
            margin-bottom: 30px;
            text-align: center;
        }
        
        .api-header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #0066cc;
        }
        
        .api-description {
            margin-bottom: 40px;
            line-height: 1.6;
            color: #333;
        }
        
        .api-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .api-table th {
            background-color: #0066cc;
            color: white;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .api-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .api-table tr:hover {
            background-color: #e9ecef;
        }
        
        .api-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }
        
        .method-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 14px;
            min-width: 60px;
            text-align: center;
        }
        
        .method-post {
            background-color: #28a745;
            color: white;
        }
        
        .method-get {
            background-color: #17a2b8;
            color: white;
        }
        
        .method-put {
            background-color: #ffc107;
            color: #212529;
        }
        
        .method-patch {
            background-color: #fd7e14;
            color: white;
        }
        
        .role-badge {
            display: inline-block;
            padding: 3px 6px;
            border-radius: 4px;
            background-color: #e9ecef;
            color: #495057;
            font-size: 12px;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        .admin-badge {
            background-color: #007bff;
            color: white;
        }
        
        .superadmin-badge {
            background-color: #dc3545;
            color: white;
        }
        
        .all-badge {
            background-color: #6c757d;
            color: white;
        }
        
        .system-badge {
            background-color: #20c997;
            color: white;
        }
        
        .contractor-badge {
            background-color: #6610f2;
            color: white;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #0066cc;
            text-decoration: none;
            font-weight: 500;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .api-section {
            margin-bottom: 40px;
        }
        
        .api-section h2 {
            color: #0066cc;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .api-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>
    <script src="js/storage.js"></script>
    <script src="js/common.js"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <img src="xf2c1ffjur.png" alt="SBTC Logo" style="width: 36px; height: auto;">
                <span>SBTC Zona 5</span>
            </div>
            <div class="nav-links">
                <a href="index.html">Dashboard</a>
                <a href="#" class="active">API Docs</a>
            </div>
            <div class="user-profile" id="userProfileHeader">
                <span id="headerUserName">Loading...</span>
                <div class="avatar" id="headerUserAvatar">?</div>
                <div class="user-dropdown">
                    <a href="profile.html">Profil</a>
                    <a href="#" id="switchAccountLink" class="switch-account-btn" style="display: none;">Switch ke Admin</a>
                    <a href="#" id="logoutLink" class="logout-btn">Logout</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="api-container">
        <a href="index.html" class="back-link">‚Üê Kembali ke Dashboard</a>
        
        <div class="api-header">
            <h1>SBTC Zona 5 API Documentation</h1>
        </div>
        
        <div class="api-description">
            <p>Dokumentasi ini berisi informasi tentang endpoints API yang tersedia untuk Sistem Manajemen Pengajuan SBTC Zona 5. API ini memungkinkan integrasi dengan sistem eksternal dan pengembangan aplikasi tambahan.</p>
            <p>Semua endpoints memerlukan autentikasi kecuali dinyatakan lain. Authentication token harus disertakan dalam header permintaan.</p>
        </div>
        
        <div class="api-section">
            <h2>API Endpoint Overview</h2>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Endpoint</th>
                        <th>Deskripsi</th>
                        <th>Roles</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="method-badge method-post">POST</span></td>
                        <td>/api/auth/login</td>
                        <td>Autentikasi</td>
                        <td><span class="role-badge all-badge">Semua</span></td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-get">GET</span></td>
                        <td>/api/dashboard/stats</td>
                        <td>Statistik pengajuan & proses</td>
                        <td>
                            <span class="role-badge admin-badge">Admin</span>
                            <span class="role-badge superadmin-badge">Superadmin</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-post">POST</span></td>
                        <td>/api/contractors</td>
                        <td>Tambah kontraktor</td>
                        <td>
                            <span class="role-badge admin-badge">Admin</span>
                            <span class="role-badge superadmin-badge">Superadmin</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-put">PUT</span></td>
                        <td>/api/contractors/:id</td>
                        <td>Edit kontraktor</td>
                        <td>
                            <span class="role-badge admin-badge">Admin</span>
                            <span class="role-badge superadmin-badge">Superadmin</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-post">POST</span></td>
                        <td>/api/workers</td>
                        <td>Tambah pekerja</td>
                        <td>
                            <span class="role-badge admin-badge">Admin</span>
                            <span class="role-badge superadmin-badge">Superadmin</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-put">PUT</span></td>
                        <td>/api/positions</td>
                        <td>Tambah/Edit posisi & requirement</td>
                        <td>
                            <span class="role-badge superadmin-badge">Superadmin</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-get">GET</span></td>
                        <td>/api/reviews/submissions</td>
                        <td>Review pengajuan</td>
                        <td>
                            <span class="role-badge admin-badge">HSSE</span>
                            <span class="role-badge admin-badge">Engineer</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-patch">PATCH</span></td>
                        <td>/api/submissions/:id/status</td>
                        <td>Update status review</td>
                        <td>
                            <span class="role-badge admin-badge">HSSE</span>
                            <span class="role-badge admin-badge">Engineer</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-post">POST</span></td>
                        <td>/api/interviews</td>
                        <td>Request jadwal interview</td>
                        <td>
                            <span class="role-badge contractor-badge">Contractor</span>
                            <span class="role-badge contractor-badge">Worker</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-patch">PATCH</span></td>
                        <td>/api/interviews/:id/approve</td>
                        <td>Approve jadwal interview</td>
                        <td>
                            <span class="role-badge admin-badge">HSSE</span>
                            <span class="role-badge admin-badge">Engineer</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-get">GET</span></td>
                        <td>/api/submissions/:id/history</td>
                        <td>Tracking detail proses</td>
                        <td>
                            <span class="role-badge all-badge">Semua</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-post">POST</span></td>
                        <td>/api/certificates</td>
                        <td>Generate sertifikat</td>
                        <td>
                            <span class="role-badge system-badge">System</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-get">GET</span></td>
                        <td>/api/reports/monthly</td>
                        <td>Laporan bulanan</td>
                        <td>
                            <span class="role-badge admin-badge">Admin</span>
                            <span class="role-badge superadmin-badge">Superadmin</span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="method-badge method-get">GET</span></td>
                        <td>/api/reports/yearly</td>
                        <td>Laporan tahunan</td>
                        <td>
                            <span class="role-badge admin-badge">Admin</span>
                            <span class="role-badge superadmin-badge">Superadmin</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="api-section">
            <h2>Authentication</h2>
            <p>Semua permintaan API memerlukan token otentikasi yang valid kecuali endpoint login. Token harus disertakan dalam header Authorization sebagai Bearer token.</p>
            
            <h3>Login (POST /api/auth/login)</h3>
            <p>Endpoint ini digunakan untuk mendapatkan token otentikasi.</p>
            
            <strong>Request Body:</strong>
            <pre style="background-color: #f8f9fa; padding: 15px; border-radius: 4px; overflow-x: auto;">
{
  "username": "string",
  "password": "string"
}
            </pre>
            
            <strong>Response:</strong>
            <pre style="background-color: #f8f9fa; padding: 15px; border-radius: 4px; overflow-x: auto;">
{
  "token": "string",
  "user": {
    "id": "number",
    "username": "string",
    "role": "string",
    "fullName": "string"
  }
}
            </pre>
        </div>
        
        <div class="api-section">
            <h2>Dashboard Statistics</h2>
            <h3>Get Dashboard Stats (GET /api/dashboard/stats)</h3>
            <p>Mendapatkan statistik untuk ditampilkan di dashboard.</p>
            
            <strong>Response:</strong>
            <pre style="background-color: #f8f9fa; padding: 15px; border-radius: 4px; overflow-x: auto;">
{
  "totalSubmissions": "number",
  "pendingReviews": "number",
  "scheduledInterviews": "number",
  "issuedCertificates": "number",
  "statusBreakdown": {
    "submitted": "number",
    "reviewed": "number",
    "approved": "number",
    "rejected": "number",
    "certified": "number"
  }
}
            </pre>
        </div>
        
        <div class="api-section">
            <h2>Documentation Resources</h2>
            <p>Dokumentasi API lengkap, termasuk contoh request dan response untuk setiap endpoint, tersedia untuk diunduh:</p>
            <ul style="list-style-type: none; padding-left: 0;">
                <li style="margin-bottom: 10px;"><a href="#" style="color: #0066cc; text-decoration: none; display: flex; align-items: center; gap: 8px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M5.523 12.424c.14-.082.293-.162.459-.238a7.878 7.878 0 0 1-.45.606c-.28.337-.498.516-.635.572a.266.266 0 0 1-.035.012.282.282 0 0 1-.026-.044c-.056-.11-.054-.216.04-.36.106-.165.319-.354.647-.548zm2.455-1.647c-.119.025-.237.05-.356.078a21.148 21.148 0 0 0 .5-1.05 12.045 12.045 0 0 0 .51.858c-.217.032-.436.07-.654.114zm2.525.939a3.881 3.881 0 0 1-.435-.41c.228.005.434.022.612.054.317.057.466.147.518.209a.095.095 0 0 1 .026.064.436.436 0 0 1-.06.2.307.307 0 0 1-.094.124.107.107 0 0 1-.069.015c-.09-.003-.258-.066-.498-.256zM8.278 6.97c-.04.244-.108.524-.2.829a4.86 4.86 0 0 1-.089-.346c-.076-.353-.087-.63-.046-.822.038-.177.11-.248.196-.283a.517.517 0 0 1 .145-.04c.013.03.028.092.032.198.005.122-.007.277-.038.465z"/>
                        <path fill-rule="evenodd" d="M4 0h5.293A1 1 0 0 1 10 .293L13.707 4a1 1 0 0 1 .293.707V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm5.5 1.5v2a1 1 0 0 0 1 1h2l-3-3zM4.165 13.668c.09.18.23.343.438.419.207.075.412.04.58-.03.318-.13.635-.436.926-.786.333-.401.683-.927 1.021-1.51a11.651 11.651 0 0 1 1.997-.406c.3.383.61.713.91.95.28.22.603.403.934.417a.856.856 0 0 0 .51-.138c.155-.101.27-.247.354-.416.09-.181.145-.37.138-.563a.844.844 0 0 0-.2-.518c-.226-.27-.596-.4-.96-.465a5.76 5.76 0 0 0-1.335-.05 10.954 10.954 0 0 1-.98-1.686c.25-.66.437-1.284.52-1.794.036-.218.055-.426.048-.614a1.238 1.238 0 0 0-.127-.538.7.7 0 0 0-.477-.365c-.202-.043-.41 0-.601.077-.377.15-.576.47-.651.823-.073.34-.04.736.046 1.136.088.406.238.848.43 1.295a19.697 19.697 0 0 1-1.062 2.227 7.662 7.662 0 0 0-1.482.645c-.37.22-.699.48-.897.787-.21.326-.275.714-.08 1.103z"/>
                    </svg>
                    Dokumentasi API Format PDF
                </a></li>
                <li style="margin-bottom: 10px;"><a href="#" style="color: #0066cc; text-decoration: none; display: flex; align-items: center; gap: 8px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V9H3V2a1 1 0 0 1 1-1h5.5v2zM3 12v-2h2v2H3zm0 1h2v2H4a1 1 0 0 1-1-1v-1zm3 2v-2h3v2H6zm4 0v-2h3v1a1 1 0 0 1-1 1h-2zm3-3h-3v-2h3v2zm-7 0v-2h3v2H6z"/>
                    </svg>
                    Swagger API Documentation
                </a></li>
                <li><a href="#" style="color: #0066cc; text-decoration: none; display: flex; align-items: center; gap: 8px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"/>
                    </svg>
                    Postman Collection
                </a></li>
            </ul>
        </div>
    </main>

    <script src="js/auth.js"></script>
    <script>
        // Initialize when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            if (window.auth && window.auth.updateUserProfileDisplay) {
                window.auth.updateUserProfileDisplay();
            }
        });
    </script>
</body>
</html>